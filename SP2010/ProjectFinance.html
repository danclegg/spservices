<script src="/SiteAssets/scripts/jquery-1.4.2.js" type="text/javascript"></script>
<script src="/SiteAssets/scripts/jquery.SPServices-0.6.1.min.js" type="text/javascript"></script>
<script src="/SiteAssets/scripts/date.js" type="text/javascript"></script>
<script src="/SiteAssets/scripts/BrowserDetect.js" type="text/javascript"></script>
<script src="/SiteAssets/scripts/jquery.simpleCombo.js" type="text/javascript"></script>
<script src="https://js-naturalsort.googlecode.com/svn/trunk/naturalSort.js" type="text/javascript"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script type="text/javascript">
var sum=0;
	var d;
	function back(data) {
		d=data;

		var results = $(d);

		project = {[]};
		$(results).find('ROW').each(function(){
			alert('found one');
			// var wo=$(this).find('WO_NUM').text();
			// var title=$(this).find('WO_TITLE').text();
			// var budget=$(this).find('BUDGET').text();
			// var ctd=$(this).find('CTD').text();
			// var billed=$(this).find('BILLED').text();
			// var labor_clr=$(this).find('LABOR_CLR').text();
			// var labor_pend=$(this).find('LABOR_PEND').text();
			// var inventory_clr=$(this).find('INVENTORY_CLR').text();
			// var inventory_pend=$(this).find('INVENTORY_PEND').text();
			// var direct_clr=$(this).find('DIRECT_CLR').text();
			// var direct_pend=$(this).find('DIRECT_PEND').text();
			// var bill_clr=$(this).find('BILL_CLR').text();
			// var bill_pend=$(this).find('BILL_PEND').text();
			// var occ_clr=$(this).find('OCC_CLR').text();
			// var occ_pend=$(this).find('OCC_PEND').text();
			// var mrc_clr=$(this).find('MRC_CLR').text();
			// var mrc_pend=$(this).find('MRC_PEND').text();
			// var rated_clr=$(this).find('RATED_CLR').text();
			// var rated_pend=$(this).find('RATED_PEND').text();
			// var project_mgr=$(this).find('PROJECT_MGR').text();
			// var create_date=$(this).find('CREATE_DATE').text();
			// var due_date=$(this).find('DUE_DATE').text();
			// var created=Date.parseExact(create_date,"dd-MM-yy");
			// var due=Date.parseExact(due_date,"dd-MM-yy");
			// var wo_cost_acct=$(this).find('WO_COST_ACCT').text();
			// var wo_status=$(this).find('WO_STATUS').text();
			// project = {"wo": wo, "title": title, "budget": Number(budget), "ctd": Number(ctd), "billed": Number(billed), "labor_clr": Number(labor_clr), "labor_pend": Number(labor_pend), "inventory_clr": Number(inventory_clr), "inventory_pend": Number(inventory_pend), "direct_clr": Number(direct_clr), "direct_pend": Number(direct_pend), "bill_clr": Number(bill_clr), "bill_pend": Number(bill_pend), "occ_clr": Number(occ_clr), "occ_pend": Number(occ_pend), "mrc_clr": Number(mrc_clr), "mrc_pend": Number(mrc_pend), "rated_clr": Number(rated_clr), "rated_pend": Number(rated_pend), "project_mgr": project_mgr, "create_date": created, "due_date": due, "wo_cost_acct": wo_cost_acct, "wo_status": wo_status};
		});		
	}


$(document).ready(function() {
		var w;

		var pWOs = new Array();
 		$().SPServices({
 			operation: "GetListItems",
 			webURL: "/",
 			async: false,
 			listName: "Details",
 			CAMLViewFields: "<ViewFields><FieldRef Name='Title' /><FieldRef Name='Value' /></ViewFields>",
 			completefunc: function (xData, Status) {
 				$(xData.responseXML).find("[nodeName=z:row]").each(function() {
 					var WO = $(this).attr("ows_Title");
					var val = $(this).attr("ows_Value");
					if (WO="WO"){
						w=val;
					}
 				});
 			}
 		});
		 		
 		//var url = "https://lmsws-stg.byu.edu/Proxy/?u"+ v +"?callback=back";
		var url="https://lmsws-stg.byu.edu/Proxy/?u=https%3A%2F%2Ftime.byu.edu%2Fapex%2Fapex_rest.getReport%3Fapp%3D106%26page%3D1%26reportid%3D111%26parmvalues%3DID-21%2CP1_REPORT_SEARCH?callback=back";
 		scriptNode = document.createElement('script');
 		scriptNode.src = url;
 		scriptNode.type = 'text/javascript';
 		document.body.appendChild(scriptNode);
 		
 });
</script>
<script type="text/javascript">
        // Load the Visualization API and the piechart package.
  google.load('visualization', '1', {'packages':['corechart', 'table']});

  // Set a callback to run when the Google Visualization API is loaded.
  google.setOnLoadCallback(drawPieChartAndTable);
  
function drawPieChartAndTable() {

	$('#table_div').html("");
	$('#table_div').append('<h3>Hours log:</h3><br />');
	var data = new google.visualization.DataTable();

	// data.addColumn('string', 'wo');
	// 	data.addColumn('string', 'title');
	// 	data.addColumn('number', 'budget');
	// 	data.addColumn('number', 'ctd');
	// 	data.addColumn('number', 'billed');
	// 	data.addColumn('number', 'labor_clr');
	// 	data.addColumn('number', 'labor_pend');
	// 	data.addColumn('number', 'inventory_clr');
	// 	data.addColumn('number', 'inventory_pend'); 
	// 	data.addColumn('number', 'direct_clr');
	// 	data.addColumn('number', 'direct_pend');
	// 	data.addColumn('number', 'bill_clr');
	// 	data.addColumn('number', 'bill_pend');
	// 	data.addColumn('number', 'occ_clr');
	// 	data.addColumn('number', 'occ_pend');
	// 	data.addColumn('number', 'mrc_clr');
	// 	data.addColumn('number', 'mrc_pend');
	// 	data.addColumn('number', 'rated_clr');
	// 	data.addColumn('number', 'rated_pend');
	// 	data.addColumn('string', 'project_mgr');
	// 	data.addColumn('date', 'create_date');
	// 	data.addColumn('date', 'due_date');
	// 	data.addColumn('string', 'wo_cost_acct');
	// 	data.addColumn('string', 'wo_status');
	// 	//data.addColumn('number', 'Budget Expended');
	// 	//data.addColumn('string', 'Time Expended');
	// 	data.addRows(1);
	// 	var exp_budget = person.ctd / person.budget;
	// 	var exp_time = person.
	// 	data.setCell(0,0,person.wo);
	// 	data.setCell(0,1,person.title);
	// 	data.setCell(0,2,person.budget);
	// 	data.setCell(0,3,person.ctd);
	// 	data.setCell(0,4,person.billed);
	// 	data.setCell(0,5,person.labor_clr);
	// 	data.setCell(0,6,person.labor_pend);
	// 	data.setCell(0,7,person.inventory_clr);
	// 	data.setCell(0,8,person.inventory_pend);
	// 	data.setCell(0,9,person.direct_clr);
	// 	data.setCell(0,10,person.direct_pend);
	// 	data.setCell(0,11,person.bill_clr);
	// 	data.setCell(0,12,person.bill_pend);
	// 	data.setCell(0,13,person.occ_clr);
	// 	data.setCell(0,14,person.occ_pend);
	// 	data.setCell(0,15,person.mrc_clr);
	// 	data.setCell(0,16,person.mrc_pend);
	// 	data.setCell(0,17,person.rated_clr);
	// 	data.setCell(0,18,person.rated_pend);
	// 	data.setCell(0,19,person.project_mgr);
	// 	data.setCell(0,20,person.create_date);
	// 	data.setCell(0,21,person.due_date);
	// 	data.setCell(0,22,person.wo_cost_acct);
	// 	data.setCell(0,23,person.wo_status);
	// 	// data.setCell(0,24,exp_budget);
	// 	//             data.setCell(0,25,person.wo_status);

}
	    
	    
	    //draw charts   
//	var gaugeTable = new google.visualization.DataView(data);
//	gaugeTable.setColumns([2,3]);
		
//		var charts = new google.visualization.PieChart(document.getElementById('budget'));
//		var chart = google.visualization.data.group(data,[1],[{'column': 2, 'aggregation': posOnly, 'type': 'number'}]);
  //      charts.draw(chart, {width: 675, height: 450, is3D: true, title: 'Percent of Budget', sliceVisibilityThreshold: 1/20000}); 	         
               
      //////

</script>

<div id="container" style="width: 1400px; height: 450px;">
	<div id="budget" class="chart" style="width:680px;float:left; position:relative;"></div>
	<div id="time" class="chart" style="width:680px;float:left; position:relative;"></div>
	<div id="table_div" class="chart" style="width:680px;float:left; position:relative;"></div>
</div>